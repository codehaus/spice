<?xml version="1.0"?>
<project
    xmlns:j="jelly:core"
    xmlns:ant="jelly:ant"
    default="jar:install">

    <postGoal name="test:compile">
        <j:set var="maven.test.dest" value="target/test-classes"/>
        <echo message="Generating test data to=${maven.test.dest}"/>
        <mkdir dir="${maven.test.dest}"/>
        <copy todir="${maven.test.dest}" >
            <fileset dir="src/test"/>
        </copy>
        <taskdef name="metagenerate"
            classname="org.realityforge.metaclass.tools.tasks.GenerateClassDescriptorsTask">
            <classpath>
                <path refid="maven.dependency.classpath"/>
                <pathelement path="${maven.build.dest}"/>
            </classpath>
        </taskdef>

        <metagenerate destDir="${maven.test.dest}">
            <fileset dir="${maven.test.dest}">
                <include name="**/data/*.java"/>
            </fileset>
        </metagenerate>
    </postGoal>

</project>


